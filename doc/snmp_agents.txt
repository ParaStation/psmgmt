
I. Requirements:

1) Installed snmp-server (snmpd), which has agentx. This version of this SNMP agent was tested with 
ucd-snmp 4.2.3 (which is included as rpm package in distributive of SUSe Linux 7.3) and 4.2.5
2) Parastation dynamically loaded libraries (files libpsi.so, libpse.so, libpshal.so). 

ps3ClusterSet.so ps3ComMyriSet.so ps3NodeSet.so and ps3TaskTable.so are compiled with options 
-rpath "/opt/parastation/lib". It means files libpsi.so, libpse.so, libpshal.so must be places 
in /opt/parastation/lib. If you have files libpsi.so, libpse.so, libpshal.so in different directory 
you can 
- create directory /opt/parastation/lib "by hand" and copy libpsi.so, libpse.so, libpshal.so to
this directory
- change "by hand" the path of search: 
    You can use the environment variable LD_LIBRARY_PATH for describing path to dll. 
F.e. LD_LIBRARY_PATH=<path>; export LD_LIBRARY_PATH.
    If you are superuser you can add directory of to file /etc/ld.so.conf and then start ldconfig.


II. Installation:

0) Let's think
    - You have installed and configured ParaStation 3 software on every node of your cluster 
    - You have installed _client_ part of SNMP on your workstation, and path to files snmpget, snmpset, snmpwalk 
    is included in PATH envinronment variable
    - You have installed and configured _server_ part of SNMP (snmpd, snmpd.conf) on every node of your cluster 
    - You have the superuser permissions for every node of cluster, on which you will install agents.
     
1) It is neccessary to know, which configuration file is used by snmpd. The name of with file is determined by
options "-c" of snmpd, and f.e the output of command ps -aux | grep "snmpd", which is started on my PC looks like

	<...>
	root      1744  0.0  1.0  4692 2696 pts/20   S    12:18   0:00 /usr/sbin/snmpd -c /etc/ucdsnmpd.conf -r -A -l /var/log/ucd-snmpd.log -P /var/run/snmpd.pid    

because I have started my snmpd with help of script /etc/init.d/snmpd.
	
2) It is neccessary to check your SNMP security subsystem, if you have one :)
    - Is your security subsystem active?
    If after command f.e.
	snmpwalk <host>  UCD-DLMOD-MIB::dlmodName
    you will have error, which looks like this:
	snmpwalk: Decryption error
    I think, you have security subsystem and this subsystem is active
    
    Example of my security subsystem - 
    a) how I can determine what configuration file is used by snmpd?
	If you have correct installed snmpd, you will have file /etc/init.d/snmpd, and in this file you
    will have a line, which looks like this:
	startproc /usr/sbin/snmpd -c /etc/ucdsnmpd.conf -f || return=$rc_failed
    It means, the name of configuration file is /etc/ucdsnmpd.conf.
    b) Security configuration of SNMP (version 3) for /etc/ucdsnmpd.conf. I create only 2 users

	############################################################################
	# for verions 3
	# createUser username (MD5|SHA) authpassphrase [DES]  [privpassphrase]

	createUser probausr MD5 attention
	createUser superusr MD5 paragone DES paranoya

	rouser probausr
	rwuser superusr

    c) Security configuration file (snmp.conf (~/.snmp/snmp.conf))

	defContext none
	defSecurityName syrchyn
	defAuthPassphrase paragone
	defPrivPassphrase paranoya
	defVersion 3
	defAuthType MD5
	defPrivType DES
	defSecurityLevel authPriv	

    d) Security part (version 3) of command line for commands snmpget, snmpwalk, snmpset
	-v 3 -u superusr -l authNoPriv -a MD5 -A paragone

3) Do you have installed dynamically loaded agents already?
	snmpwalk <security settings> <host>  UCD-DLMOD-MIB::dlmodName
    If output looks like
	enterprises.ucdavis.ucdExperimental.ucdDlmodMIB.dlmodTable.dlmodEntry.dlmodName.1 = XXXX
	enterprises.ucdavis.ucdExperimental.ucdDlmodMIB.dlmodTable.dlmodEntry.dlmodName.2 = YYYY
	<...>
    I think, you have installed agents and if output looks like this
	enterprises.ucdavis.ucdExperimental.ucdDlmodMIB.dlmodTable.dlmodEntry.dlmodName.1 = ps3ClusterSet
	enterprises.ucdavis.ucdExperimental.ucdDlmodMIB.dlmodTable.dlmodEntry.dlmodName.2 = ps3ComMyriSet
	enterprises.ucdavis.ucdExperimental.ucdDlmodMIB.dlmodTable.dlmodEntry.dlmodName.3 = ps3NodeSet
	enterprises.ucdavis.ucdExperimental.ucdDlmodMIB.dlmodTable.dlmodEntry.dlmodName.4 = ps3TaskTable
	<...>
    I think, you have installed Parastation SNMP agent's modules and you must remove it firstly, if you want to 
    reinstall it...
	
4) Installation

4.1) The installation of dynamically loaded agents modules:
    You must add to the active configuration file of snmpd (f.e. /etc/snmpd.conf) following lines:

	dlmod ps3ClusterSet /opt/parastation/lib/ps3ClusterSet.so
	dlmod ps3ComMyriSet /opt/parastation/lib/ps3ComMyriSet.so
	dlmod ps3NodeSet /opt/parastation/lib/ps3NodeSet.so
	dlmod ps3TaskTable /opt/parastation/lib/ps3TaskTable.so

     and after that you must reload the configuration of snmpd, f.e.
	 /etc/init.d/snmpd reload
     or 
	 killproc -HUP /usr/sbin/snmpd
     or 
	 sss=`cat /var/run/snmpd.pid`; kill -s HUP $sss
     or restart it
	/etc/init.d/snmpd stop
	/etc/init.d/snmpd start
	
4.2) The installation of dynamically loaded agents modules "on the fly":
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N> i create
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodName.<N> s "ps3ClusterSet" UCD-DLMOD-MIB::dlmodPath.<N> s "/opt/parastation/lib/ps3ClusterSet.so"
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N> i load	

    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N+1> i create
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodName.<N+1> s "ps3ComMyriSet" UCD-DLMOD-MIB::dlmodPath.<N> s "/opt/parastation/lib/ps3ComMyriSet.so"
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N+1> i load	

    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N+2> i create
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodName.<N+2> s "ps3NodeSet" UCD-DLMOD-MIB::dlmodPath.<N> s "/opt/parastation/lib/ps3NodeSet.so"
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N+2> i load	

    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N+3> i create
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodName.<N+3> s "ps3TaskTable" UCD-DLMOD-MIB::dlmodPath.<N> s "/opt/parastation/lib/ps3TaskTable.so"
    snmpset <security settings> <host> UCD-DLMOD-MIB::dlmodStatus.<N+3> i load	

5) The using of Parastation MIB files
    If you want to use the symbolic MIBs of Parastation SNMP parameters, you must put the files ParTec-MIB.txt and 
    ParTec-PS3-MIB.txt to ~/.snmp/mibs/ParTec-MIB.txt and ~/.snmp/mibs/ParTec-PS3-MIB.txt and add to you 
    snmp.conf lines 
    
        mibdirs +~/.snmp/mibs
        mibs +ParTec-MIB
        mibs +ParTec-PS3-MIB	
	
    or 
	<Later>
    
6) The output:
   After sucessfull installation the result of command 

	snmpwalk <security settings> <host> ParTec-MIB::partec

   will look like

	enterprises.partec.ps3.ps3Cluster.ps3NodeCount.0 = 1
	enterprises.partec.ps3.ps3Node.ps3CurrentProcLoad.0 = 0
	enterprises.partec.ps3.ps3Node.ps3CurrentTime.0 = 1045653572
	enterprises.partec.ps3.ps3Node.ps3NodeNumber.0 = 0
	enterprises.partec.ps3.ps3Node.ps3TasksCount.0 = 0
	enterprises.partec.ps3.ps3Node.ps3JobsCount.0 = 1
	enterprises.partec.ps3.ps3Node.ps3HWType.0 = 1
	enterprises.partec.ps3.ps3Node.ps3HWTypeDescr.0 = "ETHERNET "
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskIndex.1744 = 1744
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskTID.1744 = 1744
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskPTID.1744 = 0
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskConnected.1744 = 1
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskUID.1744 = 0
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskGroup.1744 = 1
	enterprises.partec.ps3.ps3ComMyri.ps3RECV.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3SEND.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3CRCERR.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3OVERRUNS.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3DESTERR.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3CONNIDERR.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3IGNORED.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3SNACK.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3CNACKHR.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3CNACKMCP.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3CNACKRS.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3CRESET.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3DLINK.0 = -1
	enterprises.partec.ps3.ps3ComMyri.ps3USEQERR.0 = -1	

    if you don't have a MyriCom card on this node of your cluster, and will look like

	enterprises.partec.ps3.ps3Cluster.ps3NodeCount.0 = 17
	enterprises.partec.ps3.ps3Node.ps3CurrentProcLoad.0 = 0
	enterprises.partec.ps3.ps3Node.ps3CurrentTime.0 = 1045654358
	enterprises.partec.ps3.ps3Node.ps3NodeNumber.0 = 10
	enterprises.partec.ps3.ps3Node.ps3TasksCount.0 = 0
	enterprises.partec.ps3.ps3Node.ps3JobsCount.0 = 1
	enterprises.partec.ps3.ps3Node.ps3HWType.0 = 3
	enterprises.partec.ps3.ps3Node.ps3HWTypeDescr.0 = "MYRINET ETHERNET "
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskIndex.683043 = 683043
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskTID.683043 = 683043
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskPTID.683043 = 0
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskConnected.683043 = 1
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskUID.683043 = 0
	enterprises.partec.ps3.ps3TaskTable.ps3TaskEntry.ps3TaskGroup.683043 = 1
	enterprises.partec.ps3.ps3ComMyri.ps3RECV.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3SEND.0 = 2
	enterprises.partec.ps3.ps3ComMyri.ps3CRCERR.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3OVERRUNS.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3DESTERR.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3CONNIDERR.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3IGNORED.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3SNACK.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3CNACKHR.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3CNACKMCP.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3CNACKRS.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3CRESET.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3DLINK.0 = 0
	enterprises.partec.ps3.ps3ComMyri.ps3USEQERR.0 = 0

    if you have a MyriCom card on this node of your cluster.     
