###################################################### -*- Makefile -*- #####
#                  ParaStation
#        Copyright (c) 2002-2004 ParTec AG, Karlsruhe
#        Copyright (c) 2005-2008 ParTec Cluster Competence Center GmbH, Munich
#############################################################################
#
# $Id$
#
# @author
#         Jens Hauke <hauke@par-tec.de>
#         Norbert Eicker <eicker@par-tec.de>
#############################################################################

export TOP_SRCDIR = $(shell cd @srcdir@;pwd)
export TARGETARGS := --target @target_cpu@-@target_vendor@-@target_os@

SUBDIRS := lib bin include scripts doc

.PHONY: all install clean distclean
all install clean distclean: $(SUBDIRS)

export TARGET
install: TARGET=install
clean: TARGET=clean
distclean: TARGET=distclean

.PHONY: $(SUBDIRS)
$(SUBDIRS):
	$(MAKE) -C $@ $(TARGET)

install: export DISTPATH=/opt/parastation

.PHONY: tar rpm srpm tag version
tar rpm srpm tag version:
	mkdir -p dist
	$(MAKE) -C dist -f $(TOP_SRCDIR)/dist/Makefile $@
