#############################################################################
#      @(#)makefile    2.00 (Karlsruhe) 2000
#
#      27.06.2000   Jens Hauke
#      23.08.2000
#############################################################################
#Create Only mcp's:
#>make mcp
#Create mcp pshal and kernelmodule:
#>make all
#Create pshal and kernelmodule:
#>make allbutmcp
#or simple
#>make
#
#On Linux use KDIR to set Kerneldir and optionalOSSUF for extra info like SMP
#>make KDIR=/usr/src/linux-2.2.16 OSSUF=_SMP
#
#On Problems with .kernelrelease call "make include/linux/version.h" as
# root inside Kerneldir

# pscommon has to be build befor psi!!
LIBS := psport pshal arg pvar pse pscommon psi putil
ifeq ("@target_os@","linux")
LIBS += psport4
endif

PSM_OSDIR := @PSM_OSDIR@

LIBDIRS := $(patsubst %,lib/%,$(LIBS))

SUBDIRS := $(LIBDIRS) kern/mcp $(PSM_OSDIR) bin dist

.PHONY all: psm lib bin
.PHONY: dist


mcp:
	$(MAKE) -C kern/mcp
psm:	mcp
	$(MAKE) -C $(PSM_OSDIR)

lib: $(LIBS)
$(LIBS): 
	$(MAKE) -C lib/$@

bin:
	$(MAKE) -C bin bin

clean:
	@for i in $(SUBDIRS) ; do \
		$(MAKE) -C $$i clean ;\
	done

dist:
	$(MAKE) -C dist










